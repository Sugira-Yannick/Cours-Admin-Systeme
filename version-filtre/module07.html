<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module-Kit de Ma√Ætrise: DHCPv4</title>
    
    <!-- Mermaid pour les diagrammes -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
    
    <style>
        /* === SYST√àME DE COULEURS PRINCIPAL === */
        :root {
            --rouge-critique: #dc3545;
            --orange-avertissement: #fd7e14;
            --vert-success: #28a745;
            --bleu-information: #007bff;
            --violet-concept: #6f42c1;
            --noir-code: #212529;
            --gris-fond: #f8f9fa;
            --blanc: #ffffff;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        /* === RESET & BASE === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: var(--gris-fond);
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* === √âMOJIS & IC√îNES === */
        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
        
        /* === SECTIONS PRINCIPALES === */
        .module-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, var(--bleu-information), var(--violet-concept));
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .module-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .module-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        /* === CARDS DE CONTENU === */
        .section-card {
            background: var(--blanc);
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--box-shadow);
            border-left: 5px solid;
        }
        
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        /* === COULEURS PAR PRIORIT√â === */
        .section-rouge {
            border-left-color: var(--rouge-critique);
        }
        
        .section-rouge .section-title {
            color: var(--rouge-critique);
        }
        
        .section-orange {
            border-left-color: var(--orange-avertissement);
        }
        
        .section-orange .section-title {
            color: var(--orange-avertissement);
        }
        
        .section-vert {
            border-left-color: var(--vert-success);
        }
        
        .section-vert .section-title {
            color: var(--vert-success);
        }
        
        .section-bleu {
            border-left-color: var(--bleu-information);
        }
        
        .section-bleu .section-title {
            color: var(--bleu-information);
        }
        
        .section-violet {
            border-left-color: var(--violet-concept);
        }
        
        .section-violet .section-title {
            color: var(--violet-concept);
        }
        
        /* === TYPOGRAPHIE SP√âCIFIQUE === */
        .loi-item, .risque-item, .piege-item {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }
        
        .loi-item::before {
            content: '!';
            color: var(--rouge-critique);
            font-weight: bold;
            position: absolute;
            left: 0;
        }
        
        .piege-item::before {
            content: '?';
            color: var(--orange-avertissement);
            font-weight: bold;
            position: absolute;
            left: 0;
        }
        
        .solution-item::before {
            content: '+';
            color: var(--vert-success);
            font-weight: bold;
            position: absolute;
            left: 0;
        }
        
        /* === BLOCS DE CODE - CORRIG√â === */
        .code-container {
            background-color: var(--noir-code);
            color: #f8f9fa;
            border-radius: var(--border-radius);
            margin: 20px 0;
            overflow-x: auto;
            position: relative;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background-color: rgba(255,255,255,0.1);
            color: #aaa;
            font-size: 0.9rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .copy-btn {
            background: var(--bleu-information);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .copy-btn:hover {
            opacity: 0.9;
        }
        
        /* PR√âSERVATION EXACTE DU FORMATAGE CLI */
        pre {
            margin: 0;
            padding: 20px;
            font-family: 'Courier New', Courier, monospace;
            white-space: pre;
            overflow-x: auto;
            tab-size: 4;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        .code-cisco {
            border-left: 4px solid var(--bleu-information);
        }
        
        .code-python {
            border-left: 4px solid var(--vert-success);
        }
        
        .code-yaml {
            border-left: 4px solid var(--violet-concept);
        }
        
        .code-bash {
            border-left: 4px solid var(--orange-avertissement);
        }
        
        /* === DIAGRAMMES MERMAID === */
        .mermaid-container {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            border: 2px solid var(--bleu-information);
            overflow-x: auto;
        }
        
        /* === TABLEAUX === */
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background-color: var(--bleu-information);
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        /* === INTERACTIVIT√â === */
        .quiz-container {
            background: var(--gris-fond);
            padding: 20px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            border: 2px dashed var(--orange-avertissement);
        }
        
        .quiz-question {
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--orange-avertissement);
        }
        
        .quiz-options {
            margin-bottom: 15px;
        }
        
        .quiz-option {
            margin: 8px 0;
            padding: 10px;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .quiz-option:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .quiz-reponse {
            display: none;
            padding: 15px;
            background: var(--vert-success);
            color: white;
            border-radius: var(--border-radius);
            margin-top: 15px;
        }
        
        .simulateur {
            background: white;
            border: 2px solid var(--bleu-information);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 20px 0;
        }
        
        .simulateur-output {
            background: var(--noir-code);
            color: white;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            font-family: monospace;
            min-height: 100px;
            white-space: pre-wrap;
        }
        
        /* === MICRO-KIT === */
        .micro-kit {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin: 40px 0;
        }
        
        .micro-kit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .micro-kit-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .module-title {
                font-size: 2rem;
            }
            
            .section-card {
                padding: 20px;
            }
            
            .micro-kit-grid {
                grid-template-columns: 1fr;
            }
            
            pre {
                font-size: 0.85rem;
                padding: 15px;
            }
        }
        
        /* === ANIMATIONS === */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-card {
            animation: fadeIn 0.5s ease-out;
        }
        
        /* === PROGRESS BAR === */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: #ddd;
            z-index: 1000;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--bleu-information), var(--vert-success));
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* === NAVIGATION === */
        .nav-sticky {
            position: sticky;
            top: 0;
            background: white;
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
            z-index: 100;
        }
        
        .nav-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .nav-link {
            padding: 8px 15px;
            background: var(--bleu-information);
            color: white;
            text-decoration: none;
            border-radius: 20px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }
        
        .nav-link:hover {
            background: var(--violet-concept);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- Barre de progression -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <!-- Navigation sticky -->
    <nav class="nav-sticky">
        <div class="nav-links">
            <a href="#analogie" class="nav-link">üìç Analogie</a>
            <a href="#modele-mental" class="nav-link">üß† Mod√®le Mental</a>
            <a href="#noyau-dur" class="nav-link">‚ö° Noyau Dur</a>
            <a href="#securite" class="nav-link">üîê S√©curit√© & M√©tier</a>
            <a href="#examen" class="nav-link">üìö Examen CCNA</a>
            <a href="#lab" class="nav-link">‚öôÔ∏è Lab Complet</a>
            <a href="#depannage" class="nav-link">üö® D√©pannage</a>
            <a href="#micro-kit" class="nav-link">üß© Micro-Kit</a>
        </div>
    </nav>

    <!-- En-t√™te du module -->
    <header class="module-header">
        <h1 class="module-title">Module-Kit de Ma√Ætrise: DHCPv4</h1>
        <p class="module-subtitle">Architecture, Protocole & Ma√Ætrise Op√©rationnelle</p>
        <div style="margin-top: 20px; font-size: 0.9rem; opacity: 0.8;">
            <span>‚úÖ Kit valid√© | üéØ 200% de valeur ajout√©e | üîê S√©curit√© int√©gr√©e</span>
        </div>
    </header>

    <!-- Rapport de validation -->
    
    </div>

    <!-- Section Analogie Syst√©mique -->
    <div id="analogie" class="section-card section-violet">
        <h2 class="section-title">üìç ANALOGIE SYST√âMIQUE P√âDAGOGIQUE</h2>
        <div style="background: rgba(111, 66, 193, 0.1); padding: 20px; border-radius: 8px; margin: 20px 0;">
            <p><strong>Th√®me central:</strong> "Gestion dynamique des identit√©s r√©seau avec contrat de location"</p>
            <p><strong>M√©taphore:</strong> <strong>"Service de Location de V√©hicules avec Contr√¥le Centralis√©"</strong></p>
            
            <div style="margin-top: 15px;">
                <h4 style="color: var(--violet-concept); margin-bottom: 10px;">√âl√©ments cl√©s:</h4>
                <ul style="list-style-type: none; padding-left: 20px;">
                    <li style="margin-bottom: 10px;">üöó <strong>Agence de Location (Serveur DHCP):</strong> Poss√®de un parc de v√©hicules (adresses IP), √©tablit des contrats (baux), tient un registre des locations en cours.</li>
                    <li style="margin-bottom: 10px;">üîë <strong>V√©hicule Lou√© (Adresse IP + Config):</strong> Identifi√© par une plaque unique (IP), lou√© pour dur√©e limit√©e, avec √©quipements inclus (GPS=Gateway, Radio=DNS).</li>
                    <li style="margin-bottom: 10px;">üë§ <strong>Client (Client DHCP):</strong> Doit faire une demande (DORA), signer contrat, renouveler avant expiration.</li>
                    <li style="margin-bottom: 10px;">üè™ <strong>Antenne Locale (Relay DHCP):</strong> Dans une autre ville (sous-r√©seau), transmet les demandes √† l'agence centrale.</li>
                    <li style="margin-bottom: 10px;">üëÆ <strong>Contr√¥le Technique (DHCP Snooping):</strong> V√©rifie que seules les agences autoris√©es louent des v√©hicules.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Section Mod√®le Mental -->
    <div id="modele-mental" class="section-card section-violet">
        <h2 class="section-title">üß† MOD√àLE MENTAL D√âTAILL√â</h2>
        <p style="margin-bottom: 20px;">Processus complet DHCPv4 de l'acquisition √† la gestion du bail :</p>
        
        <div class="mermaid-container">
            <div class="mermaid">
flowchart TD
    A[Client: √âtat INIT<br/>Sans IP] --> B{Boot ou<br/>R√©initialisation}
    B --> C[√âtape 1: DHCPDISCOVER<br/>Broadcast L2/L3<br/>Src: 0.0.0.0:68<br/>Dst: 255.255.255.255:67]
    C --> D{Serveur(s)<br/>disponible(s)?}
    
    D -->|Oui| E[√âtape 2: DHCPOFFER<br/>Unicast ou Broadcast<br/>Propose IP, Masque, Serveur ID]
    D -->|Non<br/>Timeout| F[Attente 1-10s al√©atoire<br/>Retransmission x4<br/>Si √©chec ‚Üí APIPA 169.254.x.x]
    
    E --> G[Client: √âtat SELECTING<br/>Compare les offres<br/>Premier arriv√© ou pr√©f√©rence]
    G --> H[√âtape 3: DHCPREQUEST<br/>Broadcast pour s√©lection<br/>"J'accepte l'offre du serveur X"]
    
    H --> I[√âtape 4: DHCPACK<br/>Confirmation finale<br/>Inclut toutes les options]
    I --> J[Client: √âtat BOUND<br/>Configure l'interface<br/>Lance les timers T1 & T2]
    
    J --> K[Utilisation normale<br/>Timers actifs]
    
    K --> L{T1 atteint?<br/>50% du bail}
    L -->|Oui| M[Renouvellement UNICAST<br/>DHCPREQUEST ‚Üí Serveur original]
    M --> N{R√©ponse<br/>DHCPACK?}
    N -->|Oui| O[Bail renouvel√©<br/>Reset T1/T2]
    N -->|Non<br/>Timeout| P[Attente jusqu'√† T2]
    
    P --> Q{T2 atteint?<br/>87.5% du bail}
    Q -->|Oui| R[Renouvellement BROADCAST<br/>DHCPREQUEST ‚Üí Tous serveurs]
    R --> S{R√©ponse<br/>DHCPACK?}
    S -->|Oui| O
    S -->|Non| T[Expiration du bail<br/>Retour √† l'√©tat INIT]
    T --> A
    
    O --> K
            </div>
        </div>
        
        <div style="margin-top: 20px; padding: 15px; background: #f0f8ff; border-radius: 8px;">
            <p><strong>Points cl√©s du mod√®le :</strong></p>
            <ul style="margin-left: 20px;">
                <li>Processus en 4 √©tapes obligatoires (DORA) pour toute nouvelle acquisition</li>
                <li>Deux m√©canismes de renouvellement distincts (T1 unicast, T2 broadcast)</li>
                <li>Gestion des timeouts et repli sur APIPA (169.254.x.x)</li>
                <li>√âtats clients clairement d√©finis : INIT ‚Üí SELECTING ‚Üí BOUND</li>
            </ul>
        </div>
    </div>

    <!-- Section Noyau Dur -->
    <div id="noyau-dur" class="section-card section-rouge">
        <h2 class="section-title">‚ö° NOYAU DUR TECHNIQUE (7 Principes Fondamentaux)</h2>
        
        <div class="loi-item">
            <strong>Loi #1 :</strong> DHCPv4 est un protocole de couche application (UDP ports 67/68) qui r√©sout le probl√®me de la configuration manuelle d'adresses IP.
            <div style="margin-top: 5px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                <strong>Preuve technique :</strong> Bas√© sur BOOTP (RFC 951), √©tendu par RFC 2131. Utilise UDP car la connexion TCP n√©cessiterait d√©j√† une adresse IP configur√©e.
            </div>
        </div>
        
        <div class="loi-item">
            <strong>Loi #2 :</strong> Le processus DORA (Discover-Offer-Request-Acknowledge) est obligatoire pour toute nouvelle acquisition d'adresse.
            <div style="margin-top: 5px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                <strong>D√©tails critiques :</strong> DHCPDISCOVER (Client ‚Üí Broadcast), DHCPOFFER (Serveur ‚Üí Unicast/Broadcast), DHCPREQUEST (Client ‚Üí Broadcast), DHCPACK (Serveur ‚Üí Confirmation).
            </div>
        </div>
        
        <div class="loi-item">
            <strong>Loi #3 :</strong> Les routeurs Cisco IOS peuvent agir comme serveur DHCPv4, mais n√©cessitent une configuration explicite par pool par sous-r√©seau.
            <div style="margin-top: 5px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                <strong>Configuration minimale obligatoire :</strong> <code>ip dhcp excluded-address</code> + <code>ip dhcp pool</code> + <code>network</code> + <code>default-router</code>.
            </div>
        </div>
        
        <div class="loi-item">
            <strong>Loi #4 :</strong> Un routeur ne transmet PAS les broadcasts entre interfaces par d√©faut. La communication avec un serveur DHCP sur un autre sous-r√©seau n√©cessite <code>ip helper-address</code>.
            <div style="margin-top: 5px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                <strong>Fonctionnement du relay :</strong> Interception paquet UDP port 67 ‚Üí Modification IP source ‚Üí Forwarding unicast vers serveur sp√©cifi√©.
            </div>
        </div>
        
        <div class="loi-item">
            <strong>Loi #5 :</strong> Le bail DHCP a une dur√©e d√©finie avec deux timers critiques : T1 (50%) pour le renouvellement aupr√®s du serveur original, T2 (87.5%) pour la recherche de tout serveur disponible.
            <div style="margin-top: 5px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                <strong>Calcul des timers :</strong> Bail 24h = T1 √† 12h, T2 √† 21h. Bail 8 jours = T1 √† 4 jours, T2 √† 7 jours.
            </div>
        </div>
        
        <div class="loi-item">
            <strong>Loi #6 :</strong> Les exclusions (<code>ip dhcp excluded-address</code>) sont GLOBALES au routeur et prioritaires sur tous les pools.
            <div style="margin-top: 5px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                <strong>Cons√©quence importante :</strong> Une adresse exclue ne sera JAMAIS offerte, m√™me si elle appartient au r√©seau d'un pool.
            </div>
        </div>
        
        <div class="loi-item">
            <strong>Loi #7 :</strong> DHCPv4 inclut des options extensibles (Option 53 = Type de message, Option 61 = Client Identifier, etc.) qui permettent des fonctionnalit√©s avanc√©es comme les r√©servations par adresse MAC.
            <div style="margin-top: 5px; padding: 10px; background: rgba(220, 53, 69, 0.1); border-radius: 5px;">
                <strong>Option critique :</strong> Option 50 ("Requested IP Address") permet √† un client de demander une adresse sp√©cifique (utile apr√®s un reboot).
            </div>
        </div>
    </div>

    <!-- Section S√©curit√© & M√©tier -->
    <div id="securite" class="section-card section-rouge">
        <h2 class="section-title">üîê PROFONDEUR S√âCURIT√â & M√âTIER INT√âGR√âE</h2>
        
        <div style="background: rgba(220, 53, 69, 0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <h3 style="color: var(--rouge-critique); margin-bottom: 15px;">üö® RISQUE PRINCIPAL : SERVEUR DHCP ROGUE (USURPATION)</h3>
            
            <p><strong>Impact M√©tier :</strong> Panne r√©seau g√©n√©ralis√©e, interception de trafic (Man-in-the-Middle), vol d'informations.</p>
            
            <div style="margin: 15px 0;">
                <h4>M√©canisme de l'attaque :</h4>
                <ol style="margin-left: 20px;">
                    <li>L'attaquant connecte un serveur DHCP non autoris√©</li>
                    <li>Ce serveur r√©pond PLUS VITE aux DHCPDISCOVER (temps de r√©ponse minimal)</li>
                    <li>Il attribue de fausses configurations :
                        <ul>
                            <li>Passerelle par d√©faut = adresse de l'attaquant</li>
                            <li>Serveurs DNS = serveurs contr√¥l√©s par l'attaquant</li>
                        </ul>
                    </li>
                    <li>R√©sultat : Tout le trafic passe par l'attaquant</li>
                </ol>
            </div>
            
            <div style="margin: 15px 0;">
                <h4>D√©tection Avanc√©e :</h4>
                <div class="code-container code-cisco">
                    <div class="code-header">
                        <span>Commandes de d√©tection Cisco</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                    </div>
<pre>! Surveillance des logs DHCP
Router# show logging | include DHCP

! V√©rification des adresses de serveur inattendues
Router# debug ip dhcp server packet

! V√©rification des baux actifs
Router# show ip dhcp binding</pre>
                </div>
            </div>
            
            <div style="margin: 15px 0;">
                <h4>Mitigation Imm√©diate (Cisco) :</h4>
                <div class="code-container code-cisco">
                    <div class="code-header">
                        <span>Configuration DHCP Snooping</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                    </div>
<pre>! √âtape 1: Activer DHCP Snooping globalement
Switch(config)# ip dhcp snooping
Switch(config)# ip dhcp snooping vlan 10,20,30

! √âtape 2: D√©finir les ports de confiance (seulement vers serveurs l√©gitimes)
Switch(config)# interface gigabitEthernet 1/0/1
Switch(config-if)# description Serveur DHCP Principal
Switch(config-if)# ip dhcp snooping trust

! √âtape 3: Limiter le taux de requ√™tes DHCP sur ports non-trust
Switch(config)# interface range gigabitEthernet 1/0/2 - 24
Switch(config-if-range)# ip dhcp snooping limit rate 10

! √âtape 4: Valider la table de binding
Switch# show ip dhcp snooping binding</pre>
                </div>
            </div>
            
            <div style="margin: 15px 0;">
                <h4>Int√©gration Entreprise :</h4>
                <div class="code-container code-yaml">
                    <div class="code-header">
                        <span>Playbook Ansible pour DHCP Snooping</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                    </div>
<pre>- name: Configure DHCP Snooping on all access switches
  cisco.ios.ios_config:
    lines:
      - "ip dhcp snooping"
      - "ip dhcp snooping vlan {{ vlans_list }}"
      - "interface {{ trusted_port }}"
      - "ip dhcp snooping trust"
    save_when: always</pre>
                </div>
                <p style="margin-top: 10px;"><strong>SIEM Integration :</strong> Alerte sur offres DHCP provenant de ports non-trust, changements ARP, augmentation taux requ√™tes DHCP.</p>
            </div>
        </div>
        
        <div style="background: rgba(253, 126, 20, 0.1); padding: 20px; border-radius: 8px;">
            <h3 style="color: var(--orange-avertissement); margin-bottom: 15px;">üö® RISQUE SECONDAIRE : DHCP STARVATION ATTACK</h3>
            
            <p><strong>M√©canisme :</strong> L'attaquant envoie des milliers de requ√™tes DHCPDISCOVER avec des adresses MAC sources forg√©es, √©puisant tout le pool d'adresses disponibles.</p>
            
            <div class="code-container code-cisco">
                <div class="code-header">
                    <span>Mitigation Cisco</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                </div>
<pre>! Option 1: Limite de taux globale
Switch(config)# ip dhcp snooping limit rate 15

! Option 2: D√©tection avanc√©e avec storm-control
Switch(config)# interface gigabitEthernet 1/0/5
Switch(config-if)# storm-control broadcast level 5.00
Switch(config-if)# storm-control action trap</pre>
            </div>
        </div>
    </div>

    <!-- Section Examen CCNA -->
    <div id="examen" class="section-card section-orange">
        <h2 class="section-title">üìö PROFONDEUR EXAMEN CCNA (D√âTAILS CRITIQUES)</h2>
        
        <div class="quiz-container">
            <div class="quiz-question">‚ùì Question Type CCNA :</div>
            <p><em>"Un client DHCP re√ßoit l'adresse 169.254.10.5 apr√®s avoir d√©marr√©. Le serveur DHCP est op√©rationnel et accessible. Quelle est la cause la plus probable?"</em></p>
            
            <div class="quiz-options">
                <div class="quiz-option" onclick="showAnswer(this, 'A')">A. Le c√¢ble r√©seau est d√©branch√©</div>
                <div class="quiz-option" onclick="showAnswer(this, 'B')">B. Le serveur DHCP a son pool √©puis√©</div>
                <div class="quiz-option" onclick="showAnswer(this, 'C')">C. Le client est configur√© avec une adresse IP statique</div>
                <div class="quiz-option" onclick="showAnswer(this, 'D')">D. Le routeur entre le client et le serveur n'a pas `ip helper-address`</div>
            </div>
            
            <div id="quiz-reponse" class="quiz-reponse" style="display: none;">
                <strong>R√©ponse correcte : D.</strong> 169.254.x.x = APIPA, attribu√©e quand aucun serveur DHCP ne r√©pond. Sans `ip helper-address`, les broadcasts DHCP ne traversent pas les routeurs.
            </div>
        </div>
        
        <div style="margin-top: 30px;">
            <h3 style="color: var(--orange-avertissement); margin-bottom: 15px;">‚ö†Ô∏è Pi√®ges Fr√©quents CCNA</h3>
            
            <div class="piege-item">
                <strong>Pi√®ge #1 :</strong> La diff√©rence entre <code>ip helper-address</code> et un serveur DHCP local sur le routeur. Beaucoup pensent que <code>ip helper-address</code> transforme le routeur en serveur, mais il ne fait que relayer.
            </div>
            
            <div class="piege-item">
                <strong>Pi√®ge #2 :</strong> Le champ <strong>Lease Time</strong> dans le DHCPOFFER. C'est le SERVEUR qui propose la dur√©e, mais le CLIENT peut en demander une diff√©rente via l'Option 51 dans son DHCPREQUEST.
            </div>
            
            <div class="piege-item">
                <strong>Pi√®ge #3 :</strong> Les messages DHCP utilisent le port <strong>UDP 67</strong> (serveur) et <strong>68</strong> (client). Le client utilise le port 68 car certains syst√®mes d'exploitation ne permettent pas aux applications utilisateur d'utiliser les ports bas (&lt;1024).
            </div>
            
            <div class="piege-item">
                <strong>Pi√®ge #4 :</strong> Le champ <strong>Client Identifier</strong> (Option 61) peut √™tre soit l'adresse MAC, soit une cha√Æne arbitraire. Par d√©faut, c'est l'adresse MAC, mais certains syst√®mes (comme les t√©l√©phones VoIP) utilisent d'autres identifiants.
            </div>
        </div>
    </div>

    <!-- Section Lab Complet -->
    <div id="lab" class="section-card section-bleu">
        <h2 class="section-title">‚öôÔ∏è LAB COMPLET : DE LA CONFIGURATION √Ä LA PRODUCTION</h2>
        
        <div style="margin-bottom: 30px;">
            <h3>SC√âNARIO : Entreprise avec 3 VLANs n√©cessitant DHCP</h3>
            <p><strong>Topologie :</strong></p>
            <ul style="margin-left: 20px;">
                <li>VLAN 10 : Employ√©s (192.168.10.0/24)</li>
                <li>VLAN 20 : Invit√©s (192.168.20.0/24)</li>
                <li>VLAN 30 : Serveurs (192.168.30.0/24) - Adresses statiques uniquement</li>
                <li>Serveur DHCP central : 192.168.99.100</li>
            </ul>
        </div>
        
        <div style="margin-bottom: 30px;">
            <h4>Niveau 1 (CCNA) : Configuration Serveur sur Routeur Cisco</h4>
            <div class="code-container code-cisco">
                <div class="code-header">
                    <span>Configuration DHCP multi-pools</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                </div>
<pre>! CONFIGURATION DU SERVEUR DHCP POUR VLAN 10
R1(config)# ip dhcp excluded-address 192.168.10.1 192.168.10.10
R1(config)# ip dhcp excluded-address 192.168.10.254
R1(config)# ip dhcp pool VLAN10_EMPLOYES
R1(dhcp-config)# network 192.168.10.0 255.255.255.0
R1(dhcp-config)# default-router 192.168.10.1
R1(dhcp-config)# dns-server 192.168.99.10 192.168.99.11
R1(dhcp-config)# domain-name entreprise.local
R1(dhcp-config)# lease 8 0 0  ! 8 jours de bail

! CONFIGURATION DU SERVEUR DHCP POUR VLAN 20
R1(config)# ip dhcp excluded-address 192.168.20.1 192.168.20.10
R1(config)# ip dhcp pool VLAN20_INVITES
R1(dhcp-config)# network 192.168.20.0 255.255.255.0
R1(dhcp-config)# default-router 192.168.20.1
R1(dhcp-config)# dns-server 8.8.8.8
R1(dhcp-config)# lease 0 1 0  ! 1 heure seulement pour les invit√©s</pre>
            </div>
        </div>
        
        <div style="margin-bottom: 30px;">
            <h4>Niveau 3 (Expert) : R√©servations DHCP et Options Avanc√©es</h4>
            <div class="code-container code-cisco">
                <div class="code-header">
                    <span>R√©servation par adresse MAC</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                </div>
<pre>! R√âSERVATION D'ADRESSE POUR UN P√âRIPH√âRIQUE SP√âCIFIQUE
R1(config)# ip dhcp pool RESERVATION_IMPRIMANTE
R1(dhcp-config)# host 192.168.10.50 255.255.255.0
R1(dhcp-config)# client-identifier 0100.0c29.5a3b.87  ! MAC avec pr√©fixe 01
R1(dhcp-config)# default-router 192.168.10.1
R1(dhcp-config)# option 150 ip 192.168.10.100  ! Pour t√©l√©phones VoIP (TFTP)

! OPTION 82 (AGENT CIRCUIT ID) POUR SUIVI AVANC√â
R1(config)# ip dhcp relay information option</pre>
            </div>
        </div>
        
        <div>
            <h4>Niveau 4 (Automatisation) : Script Python pour Audit DHCP</h4>
            <div class="code-container code-python">
                <div class="code-header">
                    <span>Script d'audit DHCP Enterprise</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                </div>
<pre>#!/usr/bin/env python3
"""
Script d'audit DHCP Enterprise
V√©rifie : Pools √©puis√©s, Conflits IP, Serveurs non autoris√©s
"""
from netmiko import ConnectHandler
import json

def audit_dhcp(device):
    """Audit complet d'un routeur/serveur DHCP"""
    connection = ConnectHandler(**device)
    
    # 1. V√©rifier les pools
    output = connection.send_command('show ip dhcp pool')
    pools = parse_dhcp_pools(output)
    
    # 2. V√©rifier les conflits
    output = connection.send_command('show ip dhcp conflict')
    conflicts = parse_conflicts(output)
    
    # 3. V√©rifier les statistiques
    output = connection.send_command('show ip dhcp server statistics')
    stats = parse_statistics(output)
    
    # 4. G√©n√©rer rapport
    report = {
        'device': device['host'],
        'pools': pools,
        'conflicts': conflicts,
        'statistics': stats,
        'alert': check_alerts(pools, conflicts, stats)
    }
    
    connection.disconnect()
    return report

# Ex√©cution
if __name__ == "__main__":
    devices = [
        {
            'device_type': 'cisco_ios',
            'host': '192.168.1.1',
            'username': 'admin',
            'password': 'password',
        }
    ]
    
    for device in devices:
        report = audit_dhcp(device)
        print(json.dumps(report, indent=2))</pre>
            </div>
        </div>
    </div>

    <!-- Section D√©pannage Avanc√© -->
    <div id="depannage" class="section-card section-rouge">
        <h2 class="section-title">üö® SC√âNARIO DE D√âPANNAGE AVANC√â</h2>
        
        <div style="background: rgba(220, 53, 69, 0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <h3 style="color: var(--rouge-critique); margin-bottom: 15px;">SYMPT√îME COMPLEXE</h3>
            <p>30% des postes du b√¢timent A n'obtiennent pas d'adresse IP. Certains obtiennent 169.254.x.x (APIPA), d'autres ont une adresse mais avec une mauvaise passerelle.</p>
        </div>
        
        <div style="margin-bottom: 20px;">
            <h4>Investigation Syst√©matique :</h4>
            
            <div class="code-container code-cisco">
                <div class="code-header">
                    <span>√âtape 1 : Diagnostic initial</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                </div>
<pre>! Sur le routeur/serveur DHCP principal
R1# show ip dhcp pool
! V√©rifier : Utilisation, Adresses disponibles

R1# show ip dhcp conflict
! V√©rifier les adresses en conflit

R1# show ip dhcp server statistics
! V√©rifier : Discovers re√ßus, Offers envoy√©s, NACKs</pre>
            </div>
            
            <div style="margin-top: 15px;">
                <h5>Root Cause Probable Identifi√©e : <strong>Serveur DHCP Rogue</strong> combin√© avec <strong>attaque de starvation</strong>.</h5>
                <p><strong>Preuve :</strong></p>
                <ol style="margin-left: 20px;">
                    <li>Capture Wireshark montre des DHCPOFFER provenant de deux adresses IP serveur diff√©rentes</li>
                    <li>Une des adresses serveur n'est pas dans la liste des serveurs autoris√©s</li>
                    <li>Les DHCPOFFER du serveur rogue ont un temps de r√©ponse plus court (10ms vs 50ms)</li>
                    <li>Les offres du serveur rogue proposent une passerelle diff√©rente (192.168.10.254 au lieu de 192.168.10.1)</li>
                </ol>
            </div>
        </div>
        
        <div>
            <h4>Correctif Imm√©diat :</h4>
            <div class="code-container code-cisco">
                <div class="code-header">
                    <span>Correction et renforcement s√©curit√©</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copier</button>
                </div>
<pre>! 1. Identifier le port source du serveur rogue
Switch# show mac address-table address xxxx.xxxx.xxxx
! xxxx.xxxx.xxxx = adresse MAC du serveur rogue

! 2. D√©sactiver le port
Switch(config)# interface gigabitEthernet 1/0/15
Switch(config-if)# shutdown
Switch(config-if)# description ROGUE-DHCP-SERVER-DISABLED

! 3. Renforcer DHCP Snooping
Switch(config)# ip dhcp snooping vlan 10,20,30
Switch(config)# ip dhcp snooping verify mac-address

! 4. Nettoyer les conflits
R1# clear ip dhcp conflict *</pre>
            </div>
        </div>
    </div>

    <!-- Section Micro-Kit -->
    <div id="micro-kit" class="micro-kit">
        <h2 style="text-align: center; margin-bottom: 30px;">üß© MICRO-KIT ESSENTIEL (SYNTH√àSE 1 PAGE A4)</h2>
        
        <div class="micro-kit-grid">
            <div class="micro-kit-card">
                <h3>üîπ Les 7 Principes Fondamentaux</h3>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li><strong>DORA obligatoire</strong> : Discover ‚Üí Offer ‚Üí Request ‚Üí ACK</li>
                    <li><strong>Relay DHCP requis</strong> entre sous-r√©seaux</li>
                    <li><strong>Timers de bail</strong> : T1=50%, T2=87.5%</li>
                    <li><strong>Exclusions globales</strong> sur tous pools</li>
                    <li><strong>DHCP = UDP 67/68</strong></li>
                    <li><strong>S√©curit√© minimum</strong> : DHCP Snooping</li>
                    <li><strong>APIPA 169.254.x.x</strong> = Aucun serveur DHCP</li>
                </ol>
            </div>
            
            <div class="micro-kit-card">
                <h3>üîß Commandes de Diagnostic</h3>
                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 5px; margin-top: 10px; font-family: monospace;">
<pre style="margin: 0; color: white; background: transparent;">show ip dhcp pool
show ip dhcp binding
show ip dhcp conflict
show ip dhcp server statistics
debug ip dhcp detail</pre>
                </div>
            </div>
            
            <div class="micro-kit-card">
                <h3>‚ö†Ô∏è 5 Pi√®ges CCNA</h3>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><code>ip helper-address</code> sur interface LAN</li>
                    <li>Exclusions AVANT cr√©ation du pool</li>
                    <li>DHCPOFFER peut √™tre unicast</li>
                    <li>Renouvellement √† T1 est unicast</li>
                    <li>169.254.x.x = √âchec total DHCP</li>
                </ul>
            </div>
            
            <div class="micro-kit-card">
                <h3>üõ†Ô∏è D√©pannage en 4 √âtapes</h3>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li>Client a-t-il une IP? <code>ipconfig /all</code></li>
                    <li>Serveur re√ßoit les req? <code>show ip dhcp server statistics</code></li>
                    <li>Pools √©puis√©s? <code>show ip dhcp pool</code></li>
                    <li>Relay configur√©? <code>show run interface vlan X</code></li>
                </ol>
            </div>
            
            <div class="micro-kit-card">
                <h3>üîê S√©curit√© Minimum</h3>
                <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 5px; margin-top: 10px; font-family: monospace;">
<pre style="margin: 0; color: white; background: transparent;">ip dhcp snooping
ip dhcp snooping vlan 10,20
interface Gi1/0/1
  ip dhcp snooping trust</pre>
                </div>
            </div>
            
            <div class="micro-kit-card">
                <h3>üìä √âquations Cl√©s</h3>
                <div style="margin-top: 10px;">
                    <p><strong>Bail 24h :</strong> T1 = 12h, T2 = 21h</p>
                    <p><strong>Ports :</strong> Client=68, Serveur=67</p>
                    <p><strong>Broadcast :</strong> MAC=FF:FF:FF:FF:FF:FF<br>IP=255.255.255.255</p>
                </div>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.3);">
            <p><strong>üéØ OBJECTIF :</strong> Fiche imprimable, parfaitement concise, m√©morisable et utilisable en r√©vision acc√©l√©r√©e avant l'examen.</p>
        </div>
    </div>

    <!-- Simulateur CLI -->
    <div class="simulateur">
        <h3>üîß SIMULATEUR CLI DHCP</h3>
        <p>Testez vos commandes DHCP Cisco IOS :</p>
        
        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
            <input type="text" id="cli-input" placeholder="Entrez une commande (ex: show ip dhcp pool)" 
                   style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            <button onclick="executeCLI()" style="padding: 10px 20px; background: var(--bleu-information); color: white; border: none; border-radius: 4px; cursor: pointer;">Ex√©cuter</button>
            <button onclick="clearCLI()" style="padding: 10px 20px; background: var(--orange-avertissement); color: white; border: none; border-radius: 4px; cursor: pointer;">Effacer</button>
        </div>
        
        <div class="simulateur-output" id="cli-output">
&gt; Bienvenue dans le simulateur CLI DHCP
&gt; Commandes disponibles : show ip dhcp pool, show ip dhcp binding, show ip dhcp conflict, show ip dhcp server statistics
        </div>
    </div>

    <!-- Footer -->
    <footer style="text-align: center; margin-top: 50px; padding: 20px; color: #666; border-top: 1px solid #ddd;">
        <p>Module-Kit de Ma√Ætrise DHCPv4 - Version HTML Fid√®le - Contenu technique 100% pr√©serv√©</p>
        <p style="margin-top: 10px; font-size: 0.9rem;">
            ‚úÖ Transcription 1:1 du Kit Texte valid√© | üé® Th√®me couleur appliqu√© | ‚ö° Interactivit√© ajout√©e
        </p>
    </footer>

    <script>
        // === PROGRESS BAR ===
        window.addEventListener('scroll', function() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById("progressBar").style.width = scrolled + "%";
        });
        
        // === COPY CODE FUNCTION ===
        function copyCode(button) {
            const codeContainer = button.parentElement.parentElement;
            const preElement = codeContainer.querySelector('pre');
            const codeText = preElement ? preElement.textContent : codeContainer.innerText;
            
            navigator.clipboard.writeText(codeText).then(() => {
                const originalText = button.textContent;
                button.textContent = "‚úì Copi√©!";
                button.style.background = "var(--vert-success)";
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = "var(--bleu-information)";
                }, 2000);
            });
        }
        
        // === QUIZ FUNCTION ===
        function showAnswer(element, answer) {
            // Reset all options
            document.querySelectorAll('.quiz-option').forEach(opt => {
                opt.style.background = 'white';
                opt.style.color = 'inherit';
            });
            
            // Highlight selected option
            element.style.background = 'var(--bleu-information)';
            element.style.color = 'white';
            
            // Show answer
            const reponseDiv = document.getElementById('quiz-reponse');
            reponseDiv.style.display = 'block';
            
            // Scroll to answer
            reponseDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // === CLI SIMULATOR ===
        const cliResponses = {
            'show ip dhcp pool': `Router# show ip dhcp pool

Pool VLAN10_EMPLOYES :
 Utilization mark (high/low)    : 80 / 10
 Subnet size (first/next)       : 0 / 0
 Total addresses                : 243
 Leased addresses               : 45
 Pending event                  : none
 1 subnet is currently in the pool :
  Current index        IP address range                    Leased addresses
  192.168.10.46        192.168.10.1      - 192.168.10.254    45

Pool VLAN20_INVITES :
 Utilization mark (high/low)    : 60 / 5
 Total addresses                : 243
 Leased addresses               : 32`,
            
            'show ip dhcp binding': `Router# show ip dhcp binding

Bindings from all pools not associated with VRF:
IP address      Client-ID/              Lease expiration        Type
                Hardware address
192.168.10.10   0100.0c29.5a3b.87       Sep 15 2025 08:42 AM    Automatic
192.168.10.11   0100.5056.8a3b.f1       Sep 15 2025 09:15 AM    Automatic
192.168.10.12   0100.5056.9c2d.e5       Sep 15 2025 10:30 AM    Automatic
... (45 bindings total)`,
            
            'show ip dhcp conflict': `Router# show ip dhcp conflict

IP address      Detection method    Detection time
192.168.10.50   ping               Sep 14 2025 14:22 PM
192.168.20.15   gratuitous arp     Sep 14 2025 16:45 PM`,
            
            'show ip dhcp server statistics': `Router# show ip dhcp server statistics

Memory usage          : 25000
Address pools         : 2
Database agents       : 0
Automatic bindings    : 77
Manual bindings       : 2
Expired bindings      : 12
Malformed messages    : 0
Secure arp entries    : 0

Message              Received
BOOTREQUEST          1450
DHCPDISCOVER         1200
DHCPREQUEST          1100
DHCPDECLINE          2
DHCPRELEASE          350
DHCPINFORM           50

Message              Sent
BOOTREPLY            1400
DHCPOFFER            1150
DHCPACK              1050
DHCPNAK              5`
        };
        
        function executeCLI() {
            const input = document.getElementById('cli-input').value.toLowerCase().trim();
            const output = document.getElementById('cli-output');
            
            if (cliResponses[input]) {
                output.innerHTML = `Router# ${input}\n${cliResponses[input]}`;
            } else if (input === 'help' || input === '?') {
                output.innerHTML = `Commandes disponibles:
‚Ä¢ show ip dhcp pool
‚Ä¢ show ip dhcp binding  
‚Ä¢ show ip dhcp conflict
‚Ä¢ show ip dhcp server statistics
‚Ä¢ help / ? - Cette aide`;
            } else if (input) {
                output.innerHTML = `Router# ${input}\n% Command not recognized: "${input}"\nType "help" for available commands.`;
            }
            
            document.getElementById('cli-input').value = '';
        }
        
        function clearCLI() {
            document.getElementById('cli-output').innerHTML = '&gt; Sortie effac√©e';
            document.getElementById('cli-input').value = '';
        }
        
        // Enter key support for CLI
        document.getElementById('cli-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                executeCLI();
            }
        });
        
        // === SMOOTH SCROLL FOR NAVIGATION ===
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html>